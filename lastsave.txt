
R version 4.0.2 (2020-06-22) -- "Taking Off Again"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> dir()
[1] "activity.csv"                      "Aptitude Practice Paper CIV A.pdf"
[3] "desktop.ini"                       "plot1.png"                        
[5] "plot2.png"                         "repdata_data_activity.zip"        
> #reading the data file to obtain information
> activityData<-read.csv("activity.csv")
> summary(activityData)
     steps            date              interval     
 Min.   :  0.00   Length:17568       Min.   :   0.0  
 1st Qu.:  0.00   Class :character   1st Qu.: 588.8  
 Median :  0.00   Mode  :character   Median :1177.5  
 Mean   : 37.38                      Mean   :1177.5  
 3rd Qu.: 12.00                      3rd Qu.:1766.2  
 Max.   :806.00                      Max.   :2355.0  
 NA's   :2304                                        
> names(activityData)
[1] "steps"    "date"     "interval"
> head(acitivityData)
Error in head(acitivityData) : object 'acitivityData' not found
> head(activityData)
  steps       date interval
1    NA 2012-10-01        0
2    NA 2012-10-01        5
3    NA 2012-10-01       10
4    NA 2012-10-01       15
5    NA 2012-10-01       20
6    NA 2012-10-01       25
> 
> #to calculate the total number of steps in a day
> stepsPerDay<-aggregate(steps~date,activityData,sum,na.rm=TRUE)
> #plotting histogram foo total number of steps for each day
> hist(stepsPerDay)
Error in hist.default(stepsPerDay) : 'x' must be numeric
> hist(stepsPerDay$steps)
> 
> #calculation of mean value of total number of steps
> meanStepsPerDay<-mean(stepsPerDay$steps)
> meanStepsPerDay
[1] 10766.19
> #this is the mean value
> 
> #calculation of the median value for steps in day
> medianStepsPerDay<-median(stepsPerDay$steps)
> medianStepsPerDay
[1] 10765
> #this is the median value of the data
> 
> ##AVERAGE DAILY ACTIVITY PATTERN
> # making a time series plot between the steps in a day for 5 minute interval
> stepsPerInterval<-aggregate(steps~interval,data=activityData,mean,na.rm=TRUE))
Error: unexpected ')' in "stepsPerInterval<-aggregate(steps~interval,data=activityData,mean,na.rm=TRUE))"
> stepsPerInterval<-aggregate(steps~interval,data=activityData,mean,na.rm=TRUE)
> plot(steps~interval,data=stepsPerInterval,typr="l")
Warning messages:
1: In plot.window(...) : "typr" is not a graphical parameter
2: In plot.xy(xy, type, ...) : "typr" is not a graphical parameter
3: In axis(side = side, at = at, labels = labels, ...) :
  "typr" is not a graphical parameter
4: In axis(side = side, at = at, labels = labels, ...) :
  "typr" is not a graphical parameter
5: In box(...) : "typr" is not a graphical parameter
6: In title(...) : "typr" is not a graphical parameter
> plot(steps~interval,data=stepsPerInterval,type="l")
> # finding which data interval has max number of steps
> intervalWithMaxNbSteps<-stepsPerInterval[max(stepsPerInterval),]$interval
> intervalWithMaxNbSteps
[1] NA
> #835
> 
> ##IMPUTING MISSING VALUES
> #calculation of totla missing values
> totalMissingValyes<-sum(is.na(activityData$steps))
> totalMissingValyes
[1] 2304
> #these are the total NA values in the data
> #to fill that missing values we can use the mean value at that interval. for that we are using a function
> 
> getMeanStepsPerInterval<-function(interval){
+ stepsPerInterval[stepsPerInterval$interval==interval,]$steps}
> 
> #create a new data set after filling of the missed values
> activityDataNoNA<-ativityData
Error: object 'ativityData' not found
> activityDataNoNA<-activityData
> for(i in 1:nrow(activityDataNoNA)){
+ if(is.na(activityDataNoNA[i,]$steps)){
+ activityDataNoNA[i,]$steps<-getMeanStepsPerInterval(activityDataNoNA[i,]$interval)
+ }
+ }
> # this new data set activityDataNoNA has no missing values
> 
> # plotting histogram for number of steps in eacjh day for this new dataset
> totalStepsPerDayNoNA<-aggregate(steps~date,data=activityDataNoNA,sum)
> hist(totalStepsPerDayNoNA$steps)
> 
> # calculation of mean and median for this dataset
> meanStepsPerDayNoNA<-mean(totalStepsPerDayNoNA$steps)
> meanStepsPerDayNoNA
[1] 10766.19
> medianStepsPerDayNoNA<-median(totalStepsPerDayNoNA$steps)
> medianStepsPerDayNoNA
[1] 10766.19
> 
> ##CHANGES IN ACTIVITY PATTERN IN WEEKDAYS AND WEEKENDS
> # creating factors to indicate weekdays and weekends
> activityDataNoNA$date<-as.Date(strptime(activityDataNoNA$date,format="%Y-%m-%d"))
> activityDataNoNA$day<-weekdays(activityDataNoNA$date)
> for(i in 1:nrow(activityDataNoNA)){
+ if(activityDataNoNA[i,]$day %in% c("Saturday","Sunday")){
+ activityDataNoNA[i,]$day<-"weekend"
+ }
+ else{
+ activityDataNoNA[i,]$day<-"weekday"
+ }
+ }
> stepsByDay<-aggregate(activityDataNoNA$teps~activityDataNoNA$interval+activityDataNoNA$day,activityDataNoNA,mean)
Error in model.frame.default(formula = activityDataNoNA$teps ~ activityDataNoNA$interval +  : 
  invalid type (NULL) for variable 'activityDataNoNA$teps'
> stepsByDay<-aggregate(activityDataNoNA$steps~activityDataNoNA$interval+activityDataNoNA$day,activityDataNoNA,mean)
> 
> #making a panel plot for 5 minute interval time series plot
> names(stepsByDay)<-c("interval","day","steps")
> library(lattice)
> xyplot(steps~interval|day,stepsByDay,type="l",layout=c(1,2),xlab="Interval",ylab="Number of steps")
> 
