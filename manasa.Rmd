---
title: "PEER ASSESSMENT 1 MARKDOWN FILE"
author: "MANASA GUMMA"
date: "10-07-2020"
output: html_document
---

Reading the data file to obtain information


```{r setup}
activityData<-read.csv("activity.csv")
summary(activityData)
names(activityData)
head(activityData)
```
To calculate the total number of steps in a day
```{r}
stepsPerDay<-aggregate(steps~date,activityData,sum,na.rm=TRUE)
```
Plotting histogram foo total number of steps for each day
```{r}
 hist(stepsPerDay$steps)
```
Calculation of mean value of total number of steps
```{r}
 meanStepsPerDay<-mean(stepsPerDay$steps)
meanStepsPerDay
```
Calculation of the median value for steps in day
```{r}
medianStepsPerDay<-median(stepsPerDay$steps)
 medianStepsPerDay
```
AVERAGE DAILY ACTIVITY PATTERN

Making a time series plot between the steps in a day for 5 minute interval
```{r}
stepsPerInterval<-aggregate(steps~interval,data=activityData,mean,na.rm=TRUE)
plot(steps~interval,data=stepsPerInterval,type="l")
```
finding which data interval has max number of steps
```{r}
intervalWithMaxNbSteps<-stepsPerInterval[max(stepsPerInterval),]$interval
intervalWithMaxNbSteps
```

IMPUTING MISSING VALUES

Calculation of totla missing values
```{r}
totalMissingValues<-sum(is.na(activityData$steps))
 totalMissingValues
```
These are the total NA values in the data
 
To fill that missing values we can use the mean value at that interval. for that we are using a function

```{r}
getMeanStepsPerInterval<-function(interval){
stepsPerInterval[stepsPerInterval$interval==interval,]$steps}
```

Create a new data set after filling of the missed values
```{r}
activityDataNoNA<-activityData

for(i in 1:nrow(activityDataNoNA)){
 if(is.na(activityDataNoNA[i,]$steps)){
activityDataNoNA[i,]$steps<-getMeanStepsPerInterval(activityDataNoNA[i,]$interval)
} }
```

This new data set activityDataNoNA has no missing values.

Plotting histogram for number of steps in eacjh day for this new dataset.
```{r}
totalStepsPerDayNoNA<-aggregate(steps~date,data=activityDataNoNA,sum)
hist(totalStepsPerDayNoNA$steps)
```

Calculation of mean and median for this dataset.
```{r}
meanStepsPerDayNoNA<-mean(totalStepsPerDayNoNA$steps)
meanStepsPerDayNoNA
medianStepsPerDayNoNA<-median(totalStepsPerDayNoNA$steps)
 medianStepsPerDayNoNA
```

CHANGES IN ACTIVITY PATTERN IN WEEKDAYS AND WEEKENDS

Creating factors to indicate weekdays and weekends
```{r}
activityDataNoNA$date<-as.Date(strptime(activityDataNoNA$date,format="%Y-%m-%d"))
 activityDataNoNA$day<-weekdays(activityDataNoNA$date)
for(i in 1:nrow(activityDataNoNA)){
 if(activityDataNoNA[i,]$day %in% c("Saturday","Sunday")){
 activityDataNoNA[i,]$day<-"weekend"
 }
 else{
 activityDataNoNA[i,]$day<-"weekday"
 }
}

stepsByDay<-aggregate(activityDataNoNA$steps~activityDataNoNA$interval+activityDataNoNA$day,activityDataNoNA,mean)
```

Making a panel plot for 5 minute interval time series plot.
```{r}
names(stepsByDay)<-c("interval","day","steps")
 library(lattice)
 xyplot(steps~interval|day,stepsByDay,type="l",layout=c(1,2),xlab="Interval",ylab="Number of steps")
```

This is the end of the assignment.